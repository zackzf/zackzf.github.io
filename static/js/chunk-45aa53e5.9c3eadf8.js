(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45aa53e5"],{"1b25":function(e,t,n){},"6eca":function(e,t,n){"use strict";var r=n("1b25"),o=n.n(r);o.a},"9ed6":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container blue"},[n("el-container",[n("el-main",[n("div",{staticClass:"header-logo"},[n("i",{staticClass:"iconfont icon-logo_nav"}),n("span"),n("i",{staticClass:"iconfont icon-sys-logo"})]),n("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[n("div",{staticClass:"title"},[e._v("博库登录后台")]),n("el-form-item",{attrs:{prop:"username"}},[n("i",{staticClass:"iconfont icon-username"}),n("el-input",{ref:"username",attrs:{autocomplete:"off",placeholder:"请输入用户名",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),n("el-form-item",{attrs:{prop:"password"}},[n("i",{staticClass:"iconfont icon-pwd-lock"}),n("el-input",{key:e.passwordType,ref:"password",attrs:{autocomplete:"off",type:e.passwordType,placeholder:"请输入密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),n("i",{staticClass:"iconfont icon-after",class:"password"===e.passwordType?"icon-pwd-invisible":"icon-pwd-visible",on:{click:e.showPwd}})],1),n("el-button",{staticClass:"login-btn",attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录")])],1)],1)],1)],1)},o=[],s=n("a34a"),a=n.n(s);function i(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){i(s,r,o,a,c,"next",e)}function c(e){i(s,r,o,a,c,"throw",e)}a(void 0)}))}}var l={name:"Login",data:function(){var e=function(e,t,n){t?n():n(new Error("请输入正确的用户名"))},t=function(e,t,n){t.length<1?n(new Error("请输入正确的密码，长度6-13位")):n()};return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:t}]},loading:!1,passwordType:"password",redirect:void 0,path:""}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},created:function(){},methods:{showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},sameFilter:function(e){var t=new Map;return e.filter((function(e){return!t.has(e.id)&&t.set(e.id,1)}))},handleLogin:function(){var e=this;return c(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.loginForm.validate((function(t){if(!t)return!1;var n=new URLSearchParams;n.append("username",e.loginForm.username),n.append("password",e.loginForm.password),e.loading=!0,e.$API.login(n).then((function(t){if(200===t.code){var n=t.data,r=n.id,o=n.username,s=n.tenantId,a=n.roles,i=void 0===a?[]:a;e.$store.dispatch("user/saveUserId",r),e.$store.dispatch("user/saveToken",o),e.$store.dispatch("user/saveTenantId",s);var c="";if(Array.isArray(i)&&i.length&&(e.$store.dispatch("user/saveRoles",JSON.stringify(i)),c=i[0].id,e.$store.dispatch("user/saveRoleId",c)),e.$store.state.user.token){e.loading=!1;setTimeout((function(){e.$router.push({path:"/"})}),500)}}else e.$message({type:"error",message:t.msg}),setTimeout((function(){e.loading=!1}),1e3)})).catch((function(){}))}));case 1:case"end":return t.stop()}}),t)})))()},getBots:function(e){var t=this;return c(a.a.mark((function n(){var r;return a.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$API.getAllBots(e);case 2:r=n.sent,200===r.code&&(t.$store.dispatch("user/saveBot",JSON.stringify(r.data)),r.data.length?t.$store.dispatch("user/saveBotId",r.data[0].id):t.$store.dispatch("user/saveBotId",""));case 4:case"end":return n.stop()}}),n)})))()}}},u=l,d=(n("6eca"),n("f538"),n("2877")),p=Object(d["a"])(u,r,o,!1,null,"11db3638",null);t["default"]=p.exports},b7b7:function(e,t,n){},f538:function(e,t,n){"use strict";var r=n("b7b7"),o=n.n(r);o.a}}]);